sudo: required
language: go
go:
  - tip
before_install:
  - curl -sf https://up.apex.sh/install | sudo sh
  - sudo up upgrade
script:
  - env GO111MODULE=on go build
  - env GO111MODULE=on go test

deploy:
  - provider: script
    env: DEPLOY=deploy_to_beta
    skip_cleanup: true
    script: up deploy  # https://beta.goserverless.sg/
    on:
      branch: master
  - provider: script
    env: DEPLOY=deploy_production_on_tag
    skip_cleanup: true
    script: up deploy production  # https://goserverless.sg/
    on:
      tags: true
